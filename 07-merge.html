<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Installing Git</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="container">

<h1>07 — Merge</h1>

<p>پس از ایجاد Branchهای جداگانه، در نهایت باید تغییرات آن‌ها را ترکیب کنیم.</p>
<p>این فرآیند <strong>Merge</strong> نام دارد.</p>

<hr>

<h2>Merge چیست؟</h2>

<p>Merge فرآیند ادغام تاریخچه‌ی دو Branch است.</p>
<p>Git با استفاده از گراف Commitها، تغییرات را ترکیب می‌کند و در صورت نیاز یک Commit جدید با دو Parent ایجاد می‌کند.</p>
<p>این Commit را <strong>Merge Commit</strong> می‌نامند.</p>

<hr>

<h2>مراحل Merge</h2>

<p>ابتدا به Branch مقصد بروید:</p>

<pre><code>git switch main</code></pre>

<p>سپس:</p>

<pre><code>git merge feature-login</code></pre>

<hr>

<h2>حالت‌های Merge</h2>

<h3>1️⃣ Fast-forward</h3>

<p>اگر Branch مقصد بعد از انشعاب تغییری نکرده باشد:</p>

<ul>
    <li>اشاره‌گر main جلو می‌رود</li>
    <li>Commit جدید ساخته نمی‌شود</li>
    <li>تاریخچه خطی باقی می‌ماند</li>
</ul>

<h3>2️⃣ Three-way Merge</h3>

<p>اگر هر دو Branch تغییر کرده باشند:</p>

<ul>
    <li>Git یک Merge Commit می‌سازد</li>
    <li>این Commit دو Parent دارد</li>
    <li>تاریخچه به شکل گراف درمی‌آید</li>
</ul>

<hr>

<h2>جلوگیری از Fast-forward</h2>

<p>گاهی تیم‌ها می‌خواهند حتی در صورت امکان Fast-forward، یک Merge Commit ساخته شود تا تاریخچه واضح‌تر باشد.</p>

<pre><code>git merge --no-ff feature-login</code></pre>

<p>این کار همیشه یک Merge Commit ایجاد می‌کند.</p>

<p><strong>مزیت:</strong></p>
<ul>
    <li>مشخص بودن مرز Featureها در تاریخچه</li>
</ul>

<hr>

<h2>Squash Merge</h2>

<p>گاهی نمی‌خواهیم تمام Commitهای یک Branch وارد تاریخچه اصلی شوند.</p>

<pre><code>git merge --squash feature-login</code></pre>

<p>نتیجه:</p>

<ul>
    <li>همه تغییرات Branch به‌صورت یک تغییر در Working Directory اعمال می‌شود</li>
    <li>اما Commit خودکار ساخته نمی‌شود</li>
    <li>باید یک Commit جدید بگیریم</li>
</ul>

<p><strong>کاربرد:</strong></p>

<ul>
    <li>تمیز نگه داشتن تاریخچه</li>
    <li>فشرده‌سازی Commitهای جزئی</li>
</ul>

<hr>

<h2>Merge Conflict</h2>

<p>اگر یک بخش از فایل در دو Branch متفاوت و ناسازگار تغییر کرده باشد، Git نمی‌تواند تصمیم بگیرد.</p>

<p>در این حالت:</p>

<ul>
    <li>Merge متوقف می‌شود</li>
    <li>فایل‌ها وارد وضعیت Conflict می‌شوند</li>
</ul>

<p>ساختار داخل فایل:</p>

<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
نسخه Branch فعلی
=======
نسخه Branch مقابل
&gt;&gt;&gt;&gt;&gt;&gt;&gt; feature-login
</code></pre>

<p>پس از اصلاح دستی:</p>

<pre><code> . git add 
git commit</code></pre>

<hr>

<h2>Rebase به‌جای Merge</h2>

<p>Rebase مسیر یک Branch را بازنویسی می‌کند تا روی نوک Branch مقصد قرار گیرد.</p>

<pre><code>git switch feature-login
git rebase main</code></pre>

<p>نتیجه:</p>

<ul>
    <li>تاریخچه خطی می‌شود</li>
    <li>Merge Commit ساخته نمی‌شود</li>
    <li>Commitها بازنویسی می‌شوند</li>
</ul>

<p><strong>تفاوت اصلی:</strong></p>

<ul>
    <li><strong>Merge</strong> → اتصال دو مسیر</li>
    <li><strong>Rebase</strong> → جابجایی یک مسیر روی مسیر دیگر</li>
</ul>

<hr>

<h2>هشدار مهم درباره Rebase</h2>

<p><strong>هرگز روی Branchی که به اشتراک گذاشته شده Rebase انجام ندهید.</strong></p>

<p>چون:</p>

<ul>
    <li>تاریخچه بازنویسی می‌شود</li>
    <li>باعث ناسازگاری در تیم می‌شود</li>
</ul>

<p>Rebase ابزار تمیزکاری تاریخچه محلی است.</p>

<hr>

<h2>استراتژی‌های حرفه‌ای تیمی</h2>

<h3>1️⃣ Merge Based Workflow</h3>

<ul>
    <li>هر Feature در Branch جدا</li>
    <li>Merge با --no-ff</li>
    <li>حفظ گراف کامل تاریخچه</li>
</ul>

<h3>2️⃣ Rebase + Fast-forward</h3>

<ul>
    <li>Rebase روی main</li>
    <li>سپس Fast-forward</li>
    <li>تاریخچه کاملاً خطی</li>
</ul>

<h3>3️⃣ Squash Merge</h3>

<ul>
    <li>هر Feature در یک Commit نهایی</li>
    <li>تاریخچه تمیز و خلاصه</li>
</ul>

<p>انتخاب استراتژی وابسته به سیاست تیم است.</p>
<p><strong>Consistency مهم‌تر از نوع استراتژی است.</strong></p>

<hr>

<h2>مدل ذهنی نهایی</h2>

<p>Git یک گراف جهت‌دار از Commitهاست.</p>

<ul>
    <li><strong>Merge:</strong> اتصال دو مسیر در این گراف</li>
    <li><strong>Rebase:</strong> بازنویسی مسیر برای خطی‌سازی گراف</li>
    <li><strong>Squash:</strong> فشرده‌سازی چند Snapshot به یک Snapshot</li>
</ul>

<hr>

<h2>نتیجه</h2>

<p>اکنون می‌توانید:</p>

<ul>
    <li>Merge معمولی انجام دهید</li>
    <li>Fast-forward را درک کنید</li>
    <li>--no-ff استفاده کنید</li>
    <li>Squash Merge انجام دهید</li>
    <li>Rebase را درک و مدیریت کنید</li>
    <li>Conflict را حل کنید</li>
</ul>

<p>در فصل بعد وارد مرحله حیاتی بعدی می‌شویم:</p>

<p><strong>Remote Repositories</strong></p>

</body>
</html>
